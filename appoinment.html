<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Sri Kamala Hospital - Appointment Booking</title>
<link rel="icon" type="image/png" href="favicon.png" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
<style>
:root {
    --primary: #1a76d2;
    --secondary: #34a853;
    --accent: #f37e21;
    --text: #333333;
    --light-bg: #f5f7fa;
    --shadow: 0 8px 20px rgba(0,0,0,0.1);
    --transition: all 0.3s cubic-bezier(.77,0,.18,1);
    --pulse: #e3f2fd;
    --success: #34a853;
    --error: #e53935;
}

/* Reset and base styles */
* { margin:0; padding:0; box-sizing:border-box; }
body {
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    background: linear-gradient(135deg, #00c6ff, #0072ff);
    background-size: 400% 400%;
    animation: gradientShift 15s ease infinite;
    color: var(--text);
    min-height: 100vh;
    padding: 0;
    margin: 0;
    overflow-x: hidden;
    position: relative;
}

/* Animated background */
body::before {
    content: '';
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: 
        radial-gradient(circle at 20% 80%, rgba(120, 119, 198, 0.3) 0%, transparent 50%),
        radial-gradient(circle at 80% 20%, rgba(255, 119, 198, 0.3) 0%, transparent 50%),
        radial-gradient(circle at 40% 40%, rgba(120, 219, 255, 0.3) 0%, transparent 50%);
    animation: floatingBubbles 20s ease-in-out infinite;
    z-index: -1;
}

@keyframes gradientShift {
    0% { background-position: 0% 50%; }
    50% { background-position: 100% 50%; }
    100% { background-position: 0% 50%; }
}

@keyframes floatingBubbles {
    0%, 100% { 
        transform: translateY(0px) rotate(0deg);
        opacity: 0.7;
    }
    33% { 
        transform: translateY(-30px) rotate(120deg);
        opacity: 0.4;
    }
    66% { 
        transform: translateY(30px) rotate(240deg);
        opacity: 0.6;
    }
}

/* Modern Navbar Styles */
.navbar {
    width: 100%;
    background: linear-gradient(135deg, rgba(255,255,255,0.95) 0%, rgba(248,250,252,0.95) 100%);
    backdrop-filter: blur(20px) saturate(180%);
    border-bottom: 1px solid rgba(255,255,255,0.2);
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 16px 48px;
    box-shadow: 
        0 8px 32px rgba(0,0,0,0.08),
        0 1px 0 rgba(255,255,255,0.5) inset;
    position: fixed;
    top: 0;
    left: 0;
    z-index: 999;
    animation: navbarSlideDown 1s cubic-bezier(.77,0,.18,1) forwards;
    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
}
@keyframes navbarSlideDown {
    0% { transform: translateY(-60px) scaleY(0.95); opacity: 0; }
    60% { transform: translateY(10px) scaleY(1.03); opacity: 1; }
    100% { transform: translateY(0) scaleY(1); opacity: 1; }
}
.navbar .logo {
    font-size: 1.8rem;
    font-weight: 900;
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
    letter-spacing: 2px;
    animation: logoBounceIn 1.2s cubic-bezier(.77,0,.18,1) 0.2s backwards;
    cursor: pointer;
    user-select: none;
    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    position: relative;
}
.navbar .logo:hover {
    transform: scale(1.05);
    background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
}
@keyframes logoBounceIn {
    0% { transform: scale(0.7) rotate(-10deg); opacity: 0; }
    60% { transform: scale(1.15) rotate(4deg); opacity: 1; }
    100% { transform: scale(1) rotate(0); }
}
@keyframes logoPulse {
    0% { text-shadow: 0 0 0 var(--accent);}
    100% { text-shadow: 0 0 18px var(--accent);}
}
.navbar ul {
    list-style: none;
    display: flex;
    gap: 8px;
    align-items: center;
    background: rgba(255,255,255,0.1);
    padding: 8px 16px;
    border-radius: 50px;
    backdrop-filter: blur(10px);
    border: 1px solid rgba(255,255,255,0.2);
}
.navbar ul li {
    position: relative;
}
.navbar ul li a {
    text-decoration: none;
    color: #4a5568;
    font-weight: 600;
    font-size: 0.95rem;
    padding: 12px 20px;
    border-radius: 25px;
    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    position: relative;
    overflow: hidden;
    z-index: 1;
    display: flex;
    align-items: center;
    white-space: nowrap;
}
.navbar ul li a::before {
    content: '';
    position: absolute;
    left: 0;
    top: 0;
    width: 100%;
    height: 100%;
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    border-radius: 25px;
    z-index: -1;
    opacity: 0;
    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    transform: scale(0.8);
}
.navbar ul li a:hover::before,
.navbar ul li a:focus::before {
    opacity: 1;
    transform: scale(1);
}
.navbar ul li a:hover,
.navbar ul li a:focus {
    color: white;
    transform: translateY(-2px);
    box-shadow: 0 8px 25px rgba(102, 126, 234, 0.3);
    outline: none;
}
.navbar ul li.active a,
.navbar ul li a.active {
    color: white;
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    font-weight: 700;
    box-shadow: 0 4px 15px rgba(102, 126, 234, 0.4);
}

/* Hamburger for mobile (hidden by default) */
.navbar .hamburger {
    display: none;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    width: 44px;
    height: 44px;
    cursor: pointer;
    z-index: 1001;
    margin-left: 0;
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    border: none;
    outline: none;
    border-radius: 12px;
    transition: all 0.3s ease;
    box-shadow: 0 4px 15px rgba(102, 126, 234, 0.3);
}

.navbar .hamburger:hover {
    background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
    transform: scale(1.05);
    box-shadow: 0 6px 20px rgba(240, 147, 251, 0.4);
}

.navbar .hamburger:active {
    transform: scale(0.95);
}
.navbar .hamburger span {
    display: block;
    width: 20px;
    height: 3px;
    margin: 3px 0;
    background: white;
    border-radius: 2px;
    transition: all 0.35s cubic-bezier(.77,0,.18,1);
    box-shadow: 0 1px 2px rgba(0,0,0,0.1);
}
.navbar .hamburger.active span:nth-child(1) {
    transform: translateY(6px) rotate(45deg);
}
.navbar .hamburger.active span:nth-child(2) {
    opacity: 0;
    transform: scale(0);
}
.navbar .hamburger.active span:nth-child(3) {
    transform: translateY(-6px) rotate(-45deg);
}

/* Responsive Navbar */
@media (max-width: 900px) {
    .navbar {
        padding: 14px 5vw;
    }
    .navbar ul {
        gap: 18px;
    }
}
@media (max-width: 768px) {
    .navbar {
        flex-direction: row;
        padding: 12px 4vw;
        min-height: 60px;
        justify-content: space-between;
        align-items: center;
    }
    .navbar .logo {
        font-size: 1.3rem;
        flex: 1;
    }
    .navbar .hamburger {
        display: flex;
        order: 2;
        margin-left: auto;
    }
    .navbar ul {
        flex-direction: column;
        position: absolute;
        top: 100%;
        left: 0;
        width: 100vw;
        background: linear-gradient(135deg, rgba(255,255,255,0.98) 0%, rgba(248,250,252,0.98) 100%);
        backdrop-filter: blur(20px) saturate(180%);
        box-shadow: 0 8px 32px rgba(0,0,0,0.1);
        padding: 20px 0;
        gap: 8px;
        opacity: 0;
        pointer-events: none;
        transform: translateY(-20px) scaleY(0.98);
        transition: all 0.35s cubic-bezier(.77,0,.18,1);
        z-index: 1000;
        display: flex;
        border-radius: 0 0 20px 20px;
        border: 1px solid rgba(255,255,255,0.2);
    }
    .navbar ul.open {
        opacity: 1;
        pointer-events: auto;
        transform: translateY(0) scaleY(1);
        animation: navbarMenuDrop 0.5s cubic-bezier(.77,0,.18,1);
    }
    @keyframes navbarMenuDrop {
        0% { opacity: 0; transform: translateY(-30px) scaleY(0.95);}
        100% { opacity: 1; transform: translateY(0) scaleY(1);}
    }
    .navbar ul li {
        width: 100%;
        text-align: center;
        margin: 0;
    }
    .navbar ul li a {
        display: block;
        width: calc(100% - 40px);
        margin: 0 20px;
        padding: 16px 20px;
        font-size: 1rem;
        border-radius: 15px;
        background: rgba(255,255,255,0.1);
        border: 1px solid rgba(255,255,255,0.2);
        margin-bottom: 8px;
        text-align: center;
    }
    .navbar ul li:last-child a {
        margin-bottom: 0;
    }
}
@media (max-width: 480px) {
    .navbar {
        padding: 8px 4vw;
        min-height: 55px;
    }
    .navbar .logo {
        font-size: 1.05rem;
        flex: 1;
    }
    .navbar .hamburger {
        width: 32px;
        height: 32px;
    }
    .navbar .hamburger span {
        width: 22px;
        height: 3px;
    }
    .navbar ul li a {
        font-size: 0.98rem;
        padding: 12px 0;
    }
}

/* Container and rest of styles (unchanged) */
.container {
    background: #fff;
    border-radius: 30px;
    box-shadow: 0 12px 40px 0 rgba(26,118,210,0.10), 0 1.5px 6px 0 rgba(52,168,83,0.08);
    max-width: 700px;
    width: calc(100% - 40px);
    padding: 40px;
    margin: 120px auto 40px auto;
    animation: fadeInUp 1.2s cubic-bezier(.77,0,.18,1) forwards;
    position: relative;
    overflow: hidden;
}
@keyframes fadeInUp {
    0% { opacity:0; transform: translateY(60px) scale(0.98); }
    100% { opacity:1; transform: translateY(0) scale(1); }
}
@keyframes logoImgPop {
    0% { opacity:0; transform: scale(0.8) rotate(-5deg); }
    100% { opacity:1; transform: scale(1) rotate(0); }
}
.container::before {
    content: '';
    position: absolute;
    top: -60px; left: -60px;
    width: 180px; height: 180px;
    background: radial-gradient(circle at 60% 40%, var(--primary) 0%, transparent 80%);
    opacity: 0.12;
    z-index: 0;
    pointer-events: none;
    animation: floatBlob 8s ease-in-out infinite alternate;
}
@keyframes floatBlob {
    0% { transform: scale(1) translateY(0);}
    100% { transform: scale(1.1) translateY(20px);}
}
header { text-align:center; margin-bottom:30px; position: relative; z-index: 1;}
header h1 { 
    font-size:2rem; 
    color: var(--primary); 
    margin-bottom:10px; 
    animation: fadeInDown 1.2s cubic-bezier(.77,0,.18,1) forwards; 
    letter-spacing: 1px;
    text-shadow: 0 2px 8px #e3f2fd;
}
@keyframes fadeInDown {
    0% { opacity:0; transform: translateY(-20px) scale(0.95);}
    100% { opacity:1; transform: translateY(0) scale(1);}
}
.card { 
    padding: 20px; 
    background: rgba(255,255,255,0.98);
    border-radius: 18px;
    box-shadow: 0 2px 12px 0 rgba(52,168,83,0.07);
    position: relative;
    z-index: 1;
    animation: cardPop 1.2s cubic-bezier(.77,0,.18,1) 0.2s backwards;
}
@keyframes cardPop {
    0% { opacity:0; transform: scale(0.95);}
    100% { opacity:1; transform: scale(1);}
}
.form-title {
    text-align: center;
    font-size: 1.8rem;
    color: var(--primary);
    margin-bottom: 25px;
    position: relative;
    letter-spacing: 1px;
    animation: pulseTitle 2.5s infinite alternate;
}
@keyframes pulseTitle {
    0% { text-shadow: 0 0 0 var(--accent);}
    100% { text-shadow: 0 0 12px var(--accent);}
}
.form-title::after {
    content: '';
    position: absolute;
    bottom: -10px;
    left: 50%;
    transform: translateX(-50%);
    width: 80px;
    height: 4px;
    background: linear-gradient(90deg, var(--accent), var(--primary));
    border-radius: 2px;
    animation: underlineSlide 2s infinite alternate;
}
@keyframes underlineSlide {
    0% { width: 60px;}
    100% { width: 100px;}
}
.form-group { 
    margin-bottom: 20px; 
    position: relative; 
    z-index: 1;
}
.form-group label {
    display: block;
    margin-bottom: 8px;
    font-weight: 600;
    color: var(--primary);
    transition: var(--transition);
    letter-spacing: 0.5px;
    opacity: 0.95;
}
.form-control {
    width: 100%;
    padding: 14px 20px;
    border: 2px solid #ddd;
    border-radius: 10px;
    font-size: 16px;
    transition: var(--transition);
    outline: none;
    background: #f8f9fa;
    position: relative;
    z-index: 1;
    box-shadow: 0 1.5px 6px 0 rgba(26,118,210,0.04);
}
.form-control:focus {
    border-color: var(--accent);
    box-shadow: 0 4px 16px 0 rgba(243,126,33,0.18), 0 0 0 2px var(--pulse);
    background: #fff;
    animation: inputPulse 0.7s;
}
@keyframes inputPulse {
    0% { box-shadow: 0 0 0 0 var(--pulse);}
    100% { box-shadow: 0 0 0 6px transparent;}
}
.form-group input:valid, .form-group select:valid, .form-group textarea:valid {
    border-color: var(--secondary);
    background: #f1f8e9;
    transition: border-color 0.4s, background 0.4s;
}
.form-group input:invalid:focus, .form-group select:invalid:focus, .form-group textarea:invalid:focus {
    border-color: var(--error);
    background: #ffebee;
}
.row { display: flex; flex-wrap: wrap; gap: 20px; }
.col { flex: 1; min-width: 250px; }
.btn {
    display: inline-block;
    background: var(--primary);
    color: #fff;
    padding: 15px 30px;
    border-radius: 50px;
    font-size: 16px;
    font-weight: 600;
    cursor: pointer;
    border: none;
    width: 100%;
    transition: var(--transition);
    position: relative;
    overflow: hidden;
    box-shadow: 0 2px 12px 0 rgba(26,118,210,0.10);
    z-index: 1;
    animation: btnPop 1.2s cubic-bezier(.77,0,.18,1) 0.4s backwards;
}
@keyframes btnPop {
    0% { opacity:0; transform: scale(0.9);}
    100% { opacity:1; transform: scale(1);}
}
.btn::before {
    content: '';
    position: absolute;
    width: 0;
    height: 100%;
    top: 0;
    left: 0;
    background: linear-gradient(90deg, var(--accent), var(--primary));
    transition: width 0.4s cubic-bezier(.77,0,.18,1);
    z-index: 0;
    opacity: 0.7;
}
.btn:hover::before { width: 100%; }
.btn span { position: relative; z-index: 1; }
.btn:hover { 
    transform: translateY(-2px) scale(1.04) rotate(-1deg);
    box-shadow: 0 6px 24px 0 rgba(243,126,33,0.18);
}
.text-center { text-align: center; }

/* Appointment Success Animation */
#appointmentSuccess {
    display: none;
    position: fixed;
    z-index: 2000;
    left: 0; top: 0;
    width: 100vw; height: 100vh;
    background: rgba(52,168,83,0.12);
    align-items: center;
    justify-content: center;
    animation: fadeInScale 0.7s cubic-bezier(.77,0,.18,1) forwards;
}
#appointmentSuccess .success-content {
    background: #fff;
    border-radius: 24px;
    padding: 40px 30px;
    box-shadow: 0 8px 32px 0 rgba(52,168,83,0.18);
    text-align: center;
    animation: popSuccess 0.8s cubic-bezier(.77,0,.18,1) forwards;
    position: relative;
}
@keyframes popSuccess {
    0% { transform: scale(0.7) rotate(-8deg); opacity: 0;}
    80% { transform: scale(1.08) rotate(2deg); opacity: 1;}
    100% { transform: scale(1) rotate(0);}
}
.success-checkmark {
    width: 70px; height: 70px;
    margin: 0 auto 18px auto;
    display: block;
}
.success-checkmark svg {
    width: 100%; height: 100%;
    display: block;
}
.success-checkmark .circle {
    stroke: var(--success);
    stroke-width: 6;
    fill: none;
    stroke-dasharray: 220;
    stroke-dashoffset: 220;
    animation: drawCircle 0.7s cubic-bezier(.77,0,.18,1) 0.1s forwards;
}
.success-checkmark .check {
    stroke: var(--success);
    stroke-width: 6;
    fill: none;
    stroke-dasharray: 50;
    stroke-dashoffset: 50;
    animation: drawCheck 0.5s cubic-bezier(.77,0,.18,1) 0.6s forwards;
}
@keyframes drawCircle {
    to { stroke-dashoffset: 0; }
}
@keyframes drawCheck {
    to { stroke-dashoffset: 0; }
}
.success-content h2 {
    color: var(--success);
    margin-bottom: 10px;
    font-size: 1.5rem;
    letter-spacing: 1px;
}
.success-content p {
    color: var(--text);
    font-size: 1.1rem;
    margin-bottom: 0;
}

/* Modal */
.modal {
    display: none; 
    position: fixed; 
    z-index: 1000; 
    left: 0; top: 0;
    width: 100%; height: 100%; 
    overflow: auto;
    background-color: rgba(0,0,0,0.6); 
    animation: fadeInScale 0.5s cubic-bezier(.77,0,.18,1) forwards;
}
.modal-content {
    background-color: #fff;
    margin: 15% auto; 
    padding: 30px;
    border-radius: 20px;
    width: 90%;
    max-width: 400px;
    text-align: center;
    animation: fadeInScale 0.5s cubic-bezier(.77,0,.18,1) forwards;
}
@keyframes fadeInScale {
    0% { opacity:0; transform: scale(0.7);}
    100% { opacity:1; transform: scale(1);}
}
.modal h3 { margin-bottom: 25px; }
.modal .modal-btn {
    margin: 10px 0;
    padding: 12px 20px;
    border: none;
    border-radius: 50px;
    font-size: 16px;
    cursor: pointer;
    width: 100%;
    transition: 0.3s;
}
.modal-btn:hover { opacity: 0.9; }

/* Pay at Hospital Button - Ultra Attractive Styling */
.pay-hospital { 
    background: linear-gradient(135deg, #34a853 0%, #2d8f47 50%, #34a853 100%);
    color: #fff;
    border: 2px solid transparent;
    border-radius: 20px;
    padding: 15px 20px;
    font-weight: 700;
    text-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
    letter-spacing: 0.5px;
    transition: all 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94);
    position: relative;
    overflow: hidden;
    box-shadow: 
        0 8px 25px rgba(52, 168, 83, 0.3),
        0 4px 10px rgba(52, 168, 83, 0.2),
        inset 0 1px 0 rgba(255, 255, 255, 0.2);
    min-width: 280px;
    animation: hospitalButtonGlow 3s ease-in-out infinite alternate;
}

@keyframes hospitalButtonGlow {
    0% {
        box-shadow: 
            0 8px 25px rgba(52, 168, 83, 0.3),
            0 4px 10px rgba(52, 168, 83, 0.2),
            inset 0 1px 0 rgba(255, 255, 255, 0.2);
    }
    100% {
        box-shadow: 
            0 12px 35px rgba(52, 168, 83, 0.5),
            0 6px 15px rgba(52, 168, 83, 0.3),
            inset 0 1px 0 rgba(255, 255, 255, 0.3);
    }
}

.pay-hospital::before {
    content: '';
    position: absolute;
    top: 0;
    left: -100%;
    width: 100%;
    height: 100%;
    background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.3), transparent);
    transition: left 0.6s ease;
}

.pay-hospital:hover::before {
    left: 100%;
}

.pay-hospital:hover {
    transform: translateY(-3px) scale(1.02);
    box-shadow: 
        0 15px 40px rgba(52, 168, 83, 0.4),
        0 8px 20px rgba(52, 168, 83, 0.3),
        inset 0 1px 0 rgba(255, 255, 255, 0.3);
    border-color: rgba(255, 255, 255, 0.3);
    color: #fff;
}

.pay-hospital:active {
    transform: translateY(-1px) scale(0.98);
    transition: all 0.1s ease;
}

.pay-hospital span {
    position: relative;
    z-index: 2;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 8px;
}

.pay-hospital i {
    font-size: 18px;
    transition: all 0.3s ease;
}

.pay-hospital:hover i {
    transform: rotate(5deg) scale(1.1);
    text-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
}

.pay-cashfree { background: var(--accent); color: #fff; }

/* Comprehensive Responsive Styles for Container and Form */
@media (max-width: 1200px) {
    .container {
        width: calc(100% - 30px);
        padding: 35px;
        margin: 110px auto 35px auto;
    }
}

@media (max-width: 1024px) {
    .container {
        width: calc(100% - 25px);
        padding: 30px;
        margin: 100px auto 30px auto;
    }
    .form-title {
        font-size: 1.7rem;
    }
    header h1 {
        font-size: 1.8rem;
    }
}

@media (max-width: 900px) {
    .container {
        width: calc(100% - 20px);
        padding: 25px;
        margin: 90px auto 25px auto;
    }
    .form-title {
        font-size: 1.5rem;
    }
    header h1 {
        font-size: 1.6rem;
    }
    .row {
        gap: 15px;
    }
}

@media (max-width: 768px) {
    .row { 
        flex-direction: column; 
        gap: 0; 
    }
    .container {
        width: calc(100% - 15px);
        margin: 80px auto 20px auto;
        padding: 20px;
        border-radius: 20px;
    }
    .form-title {
        font-size: 1.4rem;
        margin-bottom: 20px;
    }
    header h1 {
        font-size: 1.4rem;
        margin-bottom: 8px;
    }
    .card {
        padding: 15px;
    }
    .form-control {
        font-size: 16px;
        padding: 12px 14px;
    }
    .btn {
        font-size: 16px;
        padding: 14px 20px;
    }
    .modal-content, .modal-content-3d {
        padding: 20px;
        max-width: 95vw;
        width: 95vw;
    }
    #appointmentSuccess .success-content {
        padding: 25px 15px;
    }
    .navbar {
        padding: 12px 20px;
    }
    .navbar .logo {
        font-size: 1.1rem;
    }
}

@media (max-width: 600px) {
    .container {
        width: calc(100% - 10px);
        margin: 70px auto 15px auto;
        padding: 15px;
        border-radius: 15px;
    }
    .form-title {
        font-size: 1.3rem;
        margin-bottom: 18px;
    }
    header h1 {
        font-size: 1.3rem;
        margin-bottom: 6px;
    }
    .card {
        padding: 12px;
    }
    .form-control {
        font-size: 15px;
        padding: 10px 12px;
    }
    .btn {
        font-size: 15px;
        padding: 12px 16px;
    }
    .modal-content, .modal-content-3d {
        padding: 15px;
        max-width: 98vw;
        width: 98vw;
    }
    #appointmentSuccess .success-content {
        padding: 20px 10px;
    }
    .navbar {
        padding: 10px 15px;
    }
    .navbar .logo {
        font-size: 1rem;
    }
    .navbar ul {
        gap: 15px;
    }
    .navbar ul li a {
        font-size: 0.95rem;
        padding: 6px 12px;
    }
}

@media (max-width: 480px) {
    .container {
        width: calc(100% - 8px);
        margin: 60px auto 10px auto;
        padding: 12px;
        border-radius: 12px;
    }
    .form-title {
        font-size: 1.2rem;
        margin-bottom: 15px;
    }
    header h1 {
        font-size: 1.2rem;
        margin-bottom: 4px;
    }
    .card {
        padding: 10px;
    }
    .form-control {
        font-size: 14px;
        padding: 8px 10px;
    }
    .btn {
        font-size: 14px;
        padding: 10px 12px;
    }
    .modal-content, .modal-content-3d {
        padding: 12px;
        max-width: 99vw;
        width: 99vw;
    }
    .modal-front, .modal-back {
        padding: 12px;
    }
    #appointmentSuccess .success-content {
        padding: 15px 8px;
    }
    .navbar {
        padding: 8px 10px;
        flex-direction: column;
        gap: 8px;
    }
    .navbar .logo {
        font-size: 0.95rem;
    }
    .navbar ul {
        gap: 8px;
        flex-wrap: wrap;
        justify-content: center;
    }
    .navbar ul li a {
        font-size: 0.9rem;
        padding: 5px 8px;
    }
}

/* iPhone and small mobile devices */
@media (max-width: 414px) {
    .navbar {
        padding: 10px 4vw;
        min-height: 50px;
    }
    .navbar .logo {
        font-size: 1rem;
        flex: 1;
    }
    .navbar .hamburger {
        width: 30px;
        height: 30px;
        margin-left: auto;
    }
    .navbar .hamburger span {
        width: 20px;
        height: 2.5px;
        margin: 3px 0;
    }
}

@media (max-width: 360px) {
    .container {
        width: calc(100% - 4px);
        margin: 50px auto 8px auto;
        padding: 8px;
        border-radius: 8px;
    }
    .form-title {
        font-size: 1.1rem;
        margin-bottom: 12px;
    }
    header h1 {
        font-size: 1.1rem;
        margin-bottom: 2px;
    }
    .card {
        padding: 8px;
    }
    .form-control {
        font-size: 13px;
        padding: 6px 8px;
    }
    .btn {
        font-size: 13px;
        padding: 8px 10px;
    }
    .modal-content, .modal-content-3d {
        padding: 8px;
        max-width: 100vw;
        width: 100vw;
    }
    .modal-front, .modal-back {
        padding: 8px;
    }
    #appointmentSuccess .success-content {
        padding: 12px 4px;
    }
    .navbar {
        padding: 6px 4vw;
        min-height: 45px;
    }
    .navbar .logo {
        font-size: 0.9rem;
        flex: 1;
    }
    .navbar .hamburger {
        width: 28px;
        height: 28px;
        margin-left: auto;
    }
    .navbar .hamburger span {
        width: 18px;
        height: 2px;
        margin: 2.5px 0;
    }
    .navbar ul li a {
        font-size: 0.85rem;
        padding: 10px 0;
    }
}

/* 3D Modal Styles */
.modal-content-3d {
    perspective: 1000px;
    width: 90%;
    max-width: 400px;
    margin: 15% auto;
    position: relative;
    transform-style: preserve-3d;
    transition: transform 0.8s cubic-bezier(.77,0,.18,1);
}
.modal-front, .modal-back {
    position: absolute;
    width: 100%;
    backface-visibility: hidden;
    background: #fff;
    border-radius: 20px;
    padding: 30px;
    text-align: center;
    box-shadow: 0 8px 20px rgba(0,0,0,0.2);
    animation: modalPop 0.7s cubic-bezier(.77,0,.18,1) backwards;
}
@keyframes modalPop {
    0% { opacity:0; transform: scale(0.9);}
    100% { opacity:1; transform: scale(1);}
}
.modal-back {
    transform: rotateY(180deg);
}
.modal-content-3d.show-back {
    transform: rotateY(180deg);
}
.modal .modal-btn {
    margin: 10px 0;
    padding: 12px 20px;
    border: none;
    border-radius: 50px;
    font-size: 16px;
    cursor: pointer;
    width: 100%;
    transition: 0.3s;
}
.pay-hospital { 
    background: linear-gradient(135deg, #34a853 0%, #2d8f47 50%, #34a853 100%);
    color: #fff;
    border: 2px solid transparent;
    border-radius: 20px;
    padding: 15px 20px;
    font-weight: 700;
    text-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
    letter-spacing: 0.5px;
    transition: all 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94);
    position: relative;
    overflow: hidden;
    box-shadow: 
        0 8px 25px rgba(52, 168, 83, 0.3),
        0 4px 10px rgba(52, 168, 83, 0.2),
        inset 0 1px 0 rgba(255, 255, 255, 0.2);
    min-width: 280px;
    animation: hospitalButtonGlow 3s ease-in-out infinite alternate;
}
.pay-cashfree { background: var(--accent); color: #fff; }

/* UPI Loading Modal Styles */
.upi-loading-content {
    text-align: center;
    padding: 30px;
    max-width: 400px;
    margin: 0 auto;
}

.upi-spinner {
    position: relative;
    width: 80px;
    height: 80px;
    margin: 0 auto 20px auto;
}

.upi-spinner-ring {
    position: absolute;
    width: 100%;
    height: 100%;
    border: 4px solid transparent;
    border-top: 4px solid var(--primary);
    border-radius: 50%;
    animation: upiSpin 1.2s linear infinite;
}

.upi-spinner-ring:nth-child(2) {
    width: 70%;
    height: 70%;
    top: 15%;
    left: 15%;
    border-top-color: var(--accent);
    animation-delay: -0.4s;
}

.upi-spinner-ring:nth-child(3) {
    width: 50%;
    height: 50%;
    top: 25%;
    left: 25%;
    border-top-color: var(--secondary);
    animation-delay: -0.8s;
}

@keyframes upiSpin {
    0% { transform: rotate(0deg); }
    100% { transform: rotate(360deg); }
}

.upi-progress-bar {
    width: 100%;
    height: 6px;
    background: #e0e0e0;
    border-radius: 3px;
    overflow: hidden;
    margin-top: 20px;
}

.upi-progress-fill {
    height: 100%;
    background: linear-gradient(90deg, var(--primary), var(--accent));
    border-radius: 3px;
    animation: upiProgress 2s ease-in-out infinite;
}

@keyframes upiProgress {
    0% { width: 0%; }
    50% { width: 70%; }
    100% { width: 100%; }
}

/* Cashfree Payment Button Styles - Ultra Attractive */
.button-container{
    background: linear-gradient(135deg, #2ca6a5 0%, #1e8a8a 50%, #2ca6a5 100%);
    border: 2px solid transparent;
    border-radius: 20px;
    display: flex;
    padding: 15px 20px;
    width: fit-content;
    cursor: pointer;
    margin: 0 auto;
    transition: all 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94);
    position: relative;
    overflow: hidden;
    box-shadow: 
        0 8px 25px rgba(44, 166, 165, 0.3),
        0 4px 10px rgba(44, 166, 165, 0.2),
        inset 0 1px 0 rgba(255, 255, 255, 0.2);
    min-width: 280px;
    animation: buttonGlow 3s ease-in-out infinite alternate;
}

@keyframes buttonGlow {
    0% {
        box-shadow: 
            0 8px 25px rgba(44, 166, 165, 0.3),
            0 4px 10px rgba(44, 166, 165, 0.2),
            inset 0 1px 0 rgba(255, 255, 255, 0.2);
    }
    100% {
        box-shadow: 
            0 12px 35px rgba(44, 166, 165, 0.5),
            0 6px 15px rgba(44, 166, 165, 0.3),
            inset 0 1px 0 rgba(255, 255, 255, 0.3);
    }
}

.button-container::before {
    content: '';
    position: absolute;
    top: 0;
    left: -100%;
    width: 100%;
    height: 100%;
    background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.3), transparent);
    transition: left 0.6s ease;
}

.button-container:hover::before {
    left: 100%;
}

.button-container:hover {
    transform: translateY(-3px) scale(1.02);
    box-shadow: 
        0 15px 40px rgba(44, 166, 165, 0.4),
        0 8px 20px rgba(44, 166, 165, 0.3),
        inset 0 1px 0 rgba(255, 255, 255, 0.3);
    border-color: rgba(255, 255, 255, 0.3);
}

.button-container:active {
    transform: translateY(-1px) scale(0.98);
    transition: all 0.1s ease;
}

.text-container{
    display: flex;
    flex-direction: column;
    align-items: center;
    margin-left: 15px;
    justify-content: center;
    margin-right: 15px;
    position: relative;
    z-index: 2;
}

.logo-container{
    width: 45px;
    height: 45px;
    border-radius: 50%;
    padding: 8px;
    background: rgba(255, 255, 255, 0.15);
    backdrop-filter: blur(10px);
    border: 1px solid rgba(255, 255, 255, 0.2);
    transition: all 0.3s ease;
    box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
}

.button-container:hover .logo-container {
    transform: rotate(5deg) scale(1.1);
    background: rgba(255, 255, 255, 0.25);
    box-shadow: 0 6px 20px rgba(0, 0, 0, 0.15);
}

.seconday-logo-container{
    width: 18px;
    height: 18px;
    vertical-align: middle;
    margin-left: 5px;
    filter: brightness(1.2);
    transition: all 0.3s ease;
}

.button-container:hover .seconday-logo-container {
    transform: scale(1.1);
    filter: brightness(1.4);
}

a{
    text-decoration: none;
    display: block;
}

/* Enhanced text styling */
.text-container div:first-child {
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif !important;
    font-weight: 700 !important;
    text-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
    letter-spacing: 0.5px;
    transition: all 0.3s ease;
}

.button-container:hover .text-container div:first-child {
    transform: translateY(-1px);
    text-shadow: 0 3px 6px rgba(0, 0, 0, 0.4);
}

.text-container div:last-child {
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif !important;
    font-weight: 600 !important;
    text-shadow: 0 1px 2px rgba(0, 0, 0, 0.3);
    transition: all 0.3s ease;
}

.button-container:hover .text-container div:last-child {
    transform: translateY(-1px);
    text-shadow: 0 2px 4px rgba(0, 0, 0, 0.4);
}

/* Disabled Payment Popup Styles */
.disabled-payment-popup {
    background: linear-gradient(135deg, #fff 0%, #f8f9fa 100%);
    border-radius: 25px;
    box-shadow: 
        0 20px 60px rgba(0,0,0,0.15),
        0 8px 25px rgba(0,0,0,0.1),
        inset 0 1px 0 rgba(255,255,255,0.8);
    max-width: 450px;
    margin: 10% auto;
    animation: disabledPaymentSlideIn 0.6s cubic-bezier(.77,0,.18,1) forwards;
    position: relative;
    overflow: hidden;
}

/* Close Button for Disabled Payment Popup */
.disabled-payment-close {
    position: absolute;
    top: 15px;
    right: 15px;
    width: 35px;
    height: 35px;
    background: linear-gradient(135deg, #e74c3c 0%, #c0392b 100%);
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    z-index: 10;
    transition: all 0.3s cubic-bezier(0.25, 0.46, 0.45, 0.94);
    box-shadow: 0 4px 15px rgba(231, 76, 60, 0.3);
}

.disabled-payment-close:hover {
    transform: scale(1.1) rotate(90deg);
    box-shadow: 0 6px 20px rgba(231, 76, 60, 0.4);
    background: linear-gradient(135deg, #c0392b 0%, #a93226 100%);
}

.disabled-payment-close:active {
    transform: scale(0.95) rotate(90deg);
    transition: all 0.1s ease;
}

.disabled-payment-close i {
    color: white;
    font-size: 16px;
    font-weight: bold;
    text-shadow: 0 1px 2px rgba(0, 0, 0, 0.3);
}

@keyframes disabledPaymentSlideIn {
    0% { 
        opacity: 0; 
        transform: translateY(-50px) scale(0.9);
    }
    100% { 
        opacity: 1; 
        transform: translateY(0) scale(1);
    }
}

.disabled-payment-popup::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    height: 4px;
    background: linear-gradient(90deg, #ff6b6b, #ffa500, #ff6b6b);
    background-size: 200% 100%;
    animation: disabledPaymentShimmer 2s ease-in-out infinite;
}

@keyframes disabledPaymentShimmer {
    0% { background-position: -200% 0; }
    100% { background-position: 200% 0; }
}

.disabled-payment-content {
    text-align: center;
    padding: 40px 30px;
    position: relative;
    z-index: 1;
}

.disabled-payment-icon {
    width: 80px;
    height: 80px;
    margin: 0 auto 25px auto;
    background: linear-gradient(135deg, #ff6b6b 0%, #ffa500 100%);
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    box-shadow: 
        0 8px 25px rgba(255, 107, 107, 0.3),
        0 4px 10px rgba(255, 165, 0, 0.2);
    animation: disabledPaymentIconPulse 2s ease-in-out infinite;
}

@keyframes disabledPaymentIconPulse {
    0%, 100% { 
        transform: scale(1);
        box-shadow: 
            0 8px 25px rgba(255, 107, 107, 0.3),
            0 4px 10px rgba(255, 165, 0, 0.2);
    }
    50% { 
        transform: scale(1.05);
        box-shadow: 
            0 12px 35px rgba(255, 107, 107, 0.4),
            0 6px 15px rgba(255, 165, 0, 0.3);
    }
}

.disabled-payment-icon i {
    font-size: 32px;
    color: white;
    text-shadow: 0 2px 4px rgba(0,0,0,0.2);
    animation: disabledPaymentIconRotate 3s ease-in-out infinite;
}

@keyframes disabledPaymentIconRotate {
    0%, 100% { transform: rotate(0deg); }
    25% { transform: rotate(-5deg); }
    75% { transform: rotate(5deg); }
}

.disabled-payment-content h3 {
    color: #2c3e50;
    font-size: 1.5rem;
    margin-bottom: 15px;
    font-weight: 700;
    letter-spacing: 0.5px;
    text-shadow: 0 1px 2px rgba(0,0,0,0.1);
}

.disabled-payment-message {
    color: #5a6c7d;
    font-size: 1rem;
    line-height: 1.6;
    margin-bottom: 30px;
    padding: 0 10px;
    font-weight: 500;
}

.disabled-payment-features {
    margin-bottom: 30px;
    text-align: left;
    max-width: 300px;
    margin-left: auto;
    margin-right: auto;
}

.feature-item {
    display: flex;
    align-items: center;
    margin-bottom: 12px;
    padding: 8px 0;
    transition: all 0.3s ease;
}

.feature-item:hover {
    transform: translateX(5px);
}

.feature-item i {
    color: #27ae60;
    font-size: 16px;
    margin-right: 12px;
    width: 20px;
    text-align: center;
    animation: featureItemBounce 2s ease-in-out infinite;
}

.feature-item:nth-child(1) i { animation-delay: 0s; }
.feature-item:nth-child(2) i { animation-delay: 0.2s; }
.feature-item:nth-child(3) i { animation-delay: 0.4s; }

@keyframes featureItemBounce {
    0%, 100% { transform: scale(1); }
    50% { transform: scale(1.1); }
}

.feature-item span {
    color: #34495e;
    font-weight: 600;
    font-size: 0.95rem;
}

.disabled-payment-popup .pay-hospital {
    background: linear-gradient(135deg, #27ae60 0%, #2ecc71 100%);
    border: none;
    color: white;
    padding: 15px 30px;
    border-radius: 50px;
    font-size: 1rem;
    font-weight: 700;
    cursor: pointer;
    transition: all 0.3s cubic-bezier(0.25, 0.46, 0.45, 0.94);
    box-shadow: 
        0 8px 25px rgba(39, 174, 96, 0.3),
        0 4px 10px rgba(46, 204, 113, 0.2);
    position: relative;
    overflow: hidden;
    min-width: 250px;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 10px;
    margin: 0 auto;
}

.disabled-payment-popup .pay-hospital::before {
    content: '';
    position: absolute;
    top: 0;
    left: -100%;
    width: 100%;
    height: 100%;
    background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.3), transparent);
    transition: left 0.6s ease;
}

.disabled-payment-popup .pay-hospital:hover::before {
    left: 100%;
}

.disabled-payment-popup .pay-hospital:hover {
    transform: translateY(-3px) scale(1.02);
    box-shadow: 
        0 15px 40px rgba(39, 174, 96, 0.4),
        0 8px 20px rgba(46, 204, 113, 0.3);
}

.disabled-payment-popup .pay-hospital:active {
    transform: translateY(-1px) scale(0.98);
    transition: all 0.1s ease;
}

.disabled-payment-popup .pay-hospital i {
    font-size: 18px;
    transition: all 0.3s ease;
}

.disabled-payment-popup .pay-hospital:hover i {
    transform: rotate(5deg) scale(1.1);
}

/* Disabled Payment Buttons Container */
.disabled-payment-buttons {
    display: flex;
    flex-direction: column;
    gap: 15px;
    margin-top: 20px;
}

.disabled-payment-popup .pay-hospital-secondary {
    background: linear-gradient(135deg, #3498db 0%, #2980b9 100%);
    border: none;
    color: white;
    padding: 15px 30px;
    border-radius: 50px;
    font-size: 1rem;
    font-weight: 700;
    cursor: pointer;
    transition: all 0.3s cubic-bezier(0.25, 0.46, 0.45, 0.94);
    box-shadow: 
        0 8px 25px rgba(52, 152, 219, 0.3),
        0 4px 10px rgba(52, 152, 219, 0.2);
    position: relative;
    overflow: hidden;
    min-width: 250px;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 10px;
    margin: 0 auto;
}

.disabled-payment-popup .pay-hospital-secondary::before {
    content: '';
    position: absolute;
    top: 0;
    left: -100%;
    width: 100%;
    height: 100%;
    background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.3), transparent);
    transition: left 0.6s ease;
}

.disabled-payment-popup .pay-hospital-secondary:hover::before {
    left: 100%;
}

.disabled-payment-popup .pay-hospital-secondary:hover {
    transform: translateY(-3px) scale(1.02);
    box-shadow: 
        0 15px 40px rgba(52, 152, 219, 0.4),
        0 8px 20px rgba(52, 152, 219, 0.3);
}

.disabled-payment-popup .pay-hospital-secondary:active {
    transform: translateY(-1px) scale(0.98);
    transition: all 0.1s ease;
}

.disabled-payment-popup .pay-hospital-secondary i {
    font-size: 18px;
    transition: all 0.3s ease;
}

.disabled-payment-popup .pay-hospital-secondary:hover i {
    transform: rotate(5deg) scale(1.1);
}

/* Disabled Payment Button Styling */
.disabled-payment {
    position: relative;
    transition: all 0.3s ease;
}

.disabled-payment::after {
    content: 'ðŸ”’';
    position: absolute;
    top: 50%;
    right: 15px;
    transform: translateY(-50%);
    font-size: 20px;
    opacity: 0.8;
    z-index: 10;
}

.disabled-payment:hover {
    transform: none !important;
    box-shadow: none !important;
}

.disabled-payment:hover::before {
    left: -100% !important;
}

/* Receipt Loading Modal Styles */
.receipt-loading-content {
    text-align: center;
    padding: 40px;
    max-width: 500px;
    margin: 0 auto;
}

.receipt-animation {
    position: relative;
    width: 200px;
    height: 280px;
    margin: 0 auto 30px auto;
    perspective: 1000px;
}

.receipt-paper {
    width: 100%;
    height: 100%;
    background: #fff;
    border-radius: 8px;
    box-shadow: 
        0 4px 20px rgba(0,0,0,0.1),
        0 1px 3px rgba(0,0,0,0.08);
    position: relative;
    overflow: hidden;
    animation: receiptFloat 3s ease-in-out infinite;
    transform-style: preserve-3d;
}

@keyframes receiptFloat {
    0%, 100% { transform: translateY(0px) rotateX(0deg); }
    50% { transform: translateY(-10px) rotateX(2deg); }
}

.receipt-lines {
    padding: 20px;
    height: 100%;
    display: flex;
    flex-direction: column;
    justify-content: space-around;
}

.receipt-line {
    height: 2px;
    background: linear-gradient(90deg, #e0e0e0 0%, #c0c0c0 50%, #e0e0e0 100%);
    margin: 8px 0;
    border-radius: 1px;
    animation: receiptLineAppear 0.8s ease-in-out forwards;
    opacity: 0;
}

.receipt-line:nth-child(1) { animation-delay: 0.2s; }
.receipt-line:nth-child(2) { animation-delay: 0.4s; }
.receipt-line:nth-child(3) { animation-delay: 0.6s; }
.receipt-line:nth-child(4) { animation-delay: 0.8s; }
.receipt-line:nth-child(5) { animation-delay: 1.0s; }

@keyframes receiptLineAppear {
    0% { 
        opacity: 0; 
        transform: translateX(-20px) scaleX(0);
    }
    100% { 
        opacity: 1; 
        transform: translateX(0) scaleX(1);
    }
}

.receipt-stamp {
    position: absolute;
    top: 20px;
    right: 20px;
    animation: stampAppear 1.5s ease-out 1.2s forwards;
    opacity: 0;
    transform: scale(0);
}

.stamp-circle {
    width: 60px;
    height: 60px;
    border: 3px solid #00b88a;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    background: rgba(0, 184, 138, 0.1);
    animation: stampPulse 2s ease-in-out infinite;
}

.stamp-text {
    font-size: 12px;
    font-weight: bold;
    color: #00b88a;
    text-transform: uppercase;
    letter-spacing: 1px;
}

@keyframes stampAppear {
    0% { 
        opacity: 0; 
        transform: scale(0) rotate(-180deg);
    }
    50% { 
        opacity: 1; 
        transform: scale(1.2) rotate(-10deg);
    }
    100% { 
        opacity: 1; 
        transform: scale(1) rotate(0deg);
    }
}

@keyframes stampPulse {
    0%, 100% { 
        box-shadow: 0 0 0 0 rgba(0, 184, 138, 0.4);
    }
    50% { 
        box-shadow: 0 0 0 10px rgba(0, 184, 138, 0);
    }
}

.receipt-shine {
    position: absolute;
    top: 0;
    left: -100%;
    width: 100%;
    height: 100%;
    background: linear-gradient(
        90deg, 
        transparent, 
        rgba(255, 255, 255, 0.4), 
        transparent
    );
    animation: receiptShine 2s ease-in-out infinite;
}

@keyframes receiptShine {
    0% { left: -100%; }
    100% { left: 100%; }
}

.receipt-progress {
    margin-top: 30px;
}

.receipt-progress-bar {
    width: 100%;
    height: 8px;
    background: #e0e0e0;
    border-radius: 4px;
    overflow: hidden;
    margin-bottom: 15px;
}

.receipt-progress-fill {
    height: 100%;
    background: linear-gradient(90deg, #00b88a, #00a6b8);
    border-radius: 4px;
    animation: receiptProgress 3s ease-in-out infinite;
    position: relative;
}

.receipt-progress-fill::after {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: linear-gradient(
        90deg,
        transparent,
        rgba(255, 255, 255, 0.6),
        transparent
    );
    animation: receiptProgressShine 1.5s ease-in-out infinite;
}

@keyframes receiptProgress {
    0% { width: 0%; }
    30% { width: 30%; }
    60% { width: 70%; }
    100% { width: 100%; }
}

@keyframes receiptProgressShine {
    0% { transform: translateX(-100%); }
    100% { transform: translateX(100%); }
}

.receipt-progress-text {
    font-size: 14px;
    color: #666;
    font-weight: 500;
}

/* UPI Error Modal Styles removed - now auto-creates Pay at Hospital appointment */

/* Responsive for modal */
@media (max-width: 768px) {
    .modal-content-3d {
        max-width: 98vw;
        padding: 10px;
    }
    .modal-front, .modal-back {
        padding: 10px;
    }
    .upi-loading-content {
        padding: 20px;
    }
    .upi-spinner {
        width: 60px;
        height: 60px;
    }
    .button-container {
        padding: 12px 16px;
        margin: 15px auto;
        min-width: 250px;
        border-radius: 18px;
    }
    .pay-hospital {
        padding: 12px 16px;
        min-width: 250px;
        border-radius: 18px;
        font-size: 15px;
    }
    .logo-container {
        width: 40px;
        height: 40px;
        padding: 6px;
    }
    .text-container {
        margin-left: 12px;
        margin-right: 12px;
    }
    .text-container div:first-child {
        font-size: 13px !important;
    }
    .text-container div:last-child {
        font-size: 9px !important;
    }
    
    /* Disabled Payment Popup Responsive */
    .disabled-payment-popup {
        max-width: 95vw;
        margin: 5% auto;
        border-radius: 20px;
    }
    .disabled-payment-content {
        padding: 30px 20px;
    }
    .disabled-payment-icon {
        width: 70px;
        height: 70px;
        margin-bottom: 20px;
    }
    .disabled-payment-icon i {
        font-size: 28px;
    }
    .disabled-payment-content h3 {
        font-size: 1.3rem;
        margin-bottom: 12px;
    }
    .disabled-payment-message {
        font-size: 0.9rem;
        margin-bottom: 25px;
    }
    .disabled-payment-features {
        margin-bottom: 25px;
        max-width: 280px;
    }
    .feature-item {
        margin-bottom: 10px;
        padding: 6px 0;
    }
    .feature-item i {
        font-size: 14px;
        margin-right: 10px;
        width: 18px;
    }
    .feature-item span {
        font-size: 0.9rem;
    }
    .disabled-payment-popup .pay-hospital {
        padding: 12px 25px;
        font-size: 0.95rem;
        min-width: 220px;
    }
    .disabled-payment-popup .pay-hospital-secondary {
        padding: 12px 25px;
        font-size: 0.95rem;
        min-width: 220px;
    }
    .disabled-payment-buttons {
        gap: 12px;
        margin-top: 15px;
    }
    .disabled-payment-close {
        width: 30px;
        height: 30px;
        top: 12px;
        right: 12px;
    }
    .disabled-payment-close i {
        font-size: 14px;
    }
}
@media (max-width: 480px) {
    .modal-content-3d {
        max-width: 99vw;
        padding: 5px;
    }
    .modal-front, .modal-back {
        padding: 5px;
    }
    .upi-loading-content {
        padding: 15px;
    }
    .button-container {
        padding: 10px 14px;
        margin: 12px auto;
        min-width: 220px;
        border-radius: 16px;
    }
    .pay-hospital {
        padding: 10px 14px;
        min-width: 220px;
        border-radius: 16px;
        font-size: 14px;
    }
    .logo-container {
        width: 35px;
        height: 35px;
        padding: 5px;
    }
    .text-container {
        margin-left: 10px;
        margin-right: 10px;
    }
    .text-container div:first-child {
        font-size: 12px !important;
    }
    .text-container div:last-child {
        font-size: 8px !important;
    }
    .seconday-logo-container {
        width: 14px;
        height: 14px;
    }
    .receipt-loading-content {
        padding: 20px;
    }
    .receipt-animation {
        width: 150px;
        height: 210px;
    }
    .stamp-circle {
        width: 45px;
        height: 45px;
    }
    .stamp-text {
        font-size: 10px;
    }
    
    /* Disabled Payment Popup Mobile */
    .disabled-payment-popup {
        max-width: 98vw;
        margin: 3% auto;
        border-radius: 15px;
    }
    .disabled-payment-content {
        padding: 25px 15px;
    }
    .disabled-payment-icon {
        width: 60px;
        height: 60px;
        margin-bottom: 15px;
    }
    .disabled-payment-icon i {
        font-size: 24px;
    }
    .disabled-payment-content h3 {
        font-size: 1.2rem;
        margin-bottom: 10px;
    }
    .disabled-payment-message {
        font-size: 0.85rem;
        margin-bottom: 20px;
        line-height: 1.5;
    }
    .disabled-payment-features {
        margin-bottom: 20px;
        max-width: 250px;
    }
    .feature-item {
        margin-bottom: 8px;
        padding: 4px 0;
    }
    .feature-item i {
        font-size: 12px;
        margin-right: 8px;
        width: 16px;
    }
    .feature-item span {
        font-size: 0.85rem;
    }
    .disabled-payment-popup .pay-hospital {
        padding: 10px 20px;
        font-size: 0.9rem;
        min-width: 200px;
        border-radius: 25px;
    }
    .disabled-payment-popup .pay-hospital-secondary {
        padding: 10px 20px;
        font-size: 0.9rem;
        min-width: 200px;
        border-radius: 25px;
    }
    .disabled-payment-popup .pay-hospital i,
    .disabled-payment-popup .pay-hospital-secondary i {
        font-size: 16px;
    }
    .disabled-payment-buttons {
        gap: 10px;
        margin-top: 12px;
    }
    .disabled-payment-close {
        width: 28px;
        height: 28px;
        top: 10px;
        right: 10px;
    }
    .disabled-payment-close i {
        font-size: 12px;
    }
}
</style>
</head>
<body>

<!-- Navbar -->
<nav class="navbar" role="navigation" aria-label="Main Navigation">
    <div class="logo">Sri Kamala Hospital</div>
    <div class="hamburger" id="hamburger" aria-label="Toggle navigation menu">
        <span></span>
        <span></span>
        <span></span>
    </div>
    <ul id="nav-menu">
        <li><a href="index.html">Home</a></li>
        <li><a href="bloodtestbook.html">Blood Test(à°°à°•à±à°¤ à°ªà°°à±€à°•à±à°·)</a></li>
        <li><a href="doctors.html">Doctors</a></li>
    </ul>
</nav>

<main>
<div class="container">
    <header>
      <img src="ChatGPT Image Apr 19, 2025, 01_22_02 AM.png" style="width: 100px; max-width: 100%; height: auto; animation: logoImgPop 1.2s cubic-bezier(.77,0,.18,1) 0.1s backwards;">
        <h1>Sri Kamala Hospital</h1>
    </header>
    <div class="card">
        <h2 class="form-title">Book Your Appointment</h2>
        <br>
        <form id="appointmentForm" autocomplete="off">
            <div class="row">
                <div class="col">
                    <div class="form-group">
                        <label for="fullName">Full Name-à°ªà±‚à°°à±à°¤à°¿ à°ªà±‡à°°à±</label>
                        <input type="text" id="fullName" class="form-control" placeholder="Full name-(à°®à±€ à°ªà±‚à°°à±à°¤à°¿ à°ªà±‡à°°à±)" required>
                    </div>
                </div>
                <div class="col">
                    <div class="form-group">
                        <label for="phone">Phone Number-à°«à±‹à°¨à± à°¨à°‚à°¬à°°à±</label>
                        <input type="tel" id="phone" class="form-control" placeholder="Phone number-(à°«à±‹à°¨à± à°¨à°‚à°¬à°°à±)" required pattern="[0-9]{10,}">
                    </div>
                </div>
            </div>

            <div class="row">
                <div class="col">
                    <div class="form-group">
                        <label for="age">Age-à°µà°¯à°¸à±à°¸à±</label>
                        <input type="number" id="age" class="form-control" placeholder="Enter your age-(à°®à±€ à°µà°¯à°¸à±à°¸à±)" required min="1" max="120">
                    </div>
                </div>
                <div class="col">
                    <div class="form-group">
                        <label for="gender">Gender-à°²à°¿à°‚à°—à°‚</label>
                        <select id="gender" class="form-control" required>
                            <option value="">Gender-à°²à°¿à°‚à°—à°‚</option>
                            <option value="male">Male(à°ªà±à°°à±à°·à±à°¡à±)</option>
                            <option value="female">Female(à°®à°¹à°¿à°³)</option>
                            <option value="other">Other(à°‡à°¤à°°)</option>
                        </select>
                    </div>
                </div>
            </div>

            <div class="row">
                <div class="col">
                    <div class="form-group">
                        <label for="role">Role-à°µà±ˆà°¦à±à°¯ à°°à±‹à°²à±</label>
                        <select id="role" class="form-control" required>
                            <option value="">Role -à°°à±‹à°²à± à°Žà°‚à°šà±à°•à±‹à°‚à°¡à°¿</option>
                            <option value="general">General Physician(à°œà°¨à°°à°²à± à°«à°¿à°œà±€à°·à°¿à°¯à°¨à±)</option>
                            <option value="cardio">Cardiologist(à°•à°¾à°°à±à°¡à°¿à°¯à°¾à°²à°œà°¿à°¸à±à°Ÿà±)</option>
                            <option value="ortho">Orthopedist(à°†à°°à±à°¥à±‹à°ªà±†à°¡à°¿à°¸à±à°Ÿà±)</option>
                        </select>
                    </div>
                </div>
                <div class="col">
                    <div class="form-group">
                        <label for="date">Appointment Date-à°¤à±‡à°¦à±€</label>
                        <input type="date" id="date" class="form-control" required>
                    </div>
                </div>
            </div>

            <div class="row">
                <div class="col">
                    <div class="form-group">
                        <label for="time">Preferred Time-à°•à±‹à°°à±à°•à±à°¨à±à°¨ à°¸à°®à°¯à°‚</label>
                        <select id="time" class="form-control" required>
                            <option value="">Select Time Slot-à°Ÿà±ˆà°®à± à°¸à±à°²à°¾à°Ÿà± à°Žà°‚à°šà±à°•à±‹à°‚à°¡à°¿</option>
                            <option value="09:00 AM">09:00 AM</option>
                            <option value="10:00 AM">10:00 AM</option>
                            <option value="11:00 AM">11:00 AM</option>
                            <option value="12:00 PM">12:00 PM</option>
                            <option value="02:00 PM">02:00 PM</option>
                            <option value="03:00 PM">03:00 PM</option>
                            <option value="04:00 PM">04:00 PM</option>
                            <option value="05:00 PM">05:00 PM</option>
                        </select>
                    </div>
                </div>
            </div>

            <div class="form-group">
                <label for="reason">Reason for Visit-à°Žà°‚à°¦à±à°•à± à°µà°¸à±à°¤à±à°¨à±à°¨à°¾à°°à±</label>
                <textarea id="reason" class="form-control" rows="3" placeholder="Briefly describe(à°®à±€ à°²à°•à±à°·à°£à°¾à°²à±/à°•à°¾à°°à°£à°‚ à°µà°¿à°µà°°à°¿à°‚à°šà°‚à°¡à°¿)"></textarea>
            </div>

            <div class="text-center">
                <button type="submit" class="btn" id="appointmentBtn"><span><i class="fas fa-calendar-check"></i>Book Appointment(à°¬à±à°•à± à°šà±‡à°¯à°‚à°¡à°¿)</span></button>
            </div>
        </form>
    </div>
</div>
</main>

<!-- Appointment Success Animation Popup -->
<div id="appointmentSuccess">
    <div class="success-content">
        <div class="success-checkmark">
            <svg viewBox="0 0 80 80">
                <circle class="circle" cx="40" cy="40" r="35"/>
                <polyline class="check" points="25,43 37,55 57,30"/>
            </svg>
        </div>
        <h2>Appointment Booked!</h2>
        <p id="successToken"></p>
    </div>
</div>

<!-- 3D Animated Payment Popup -->
<div class="modal" id="paymentModal">
    <div class="modal-content-3d" id="modal3d">
        <div class="modal-front">
            <h3>Payment Method (à°šà±†à°²à±à°²à°¿à°‚à°ªà± à°ªà°¦à±à°§à°¤à°¿à°¨à°¿)</h3>
            <button class="modal-btn pay-hospital" onclick="payAtHospital()">Pay at Hospital-à°¹à°¾à°¸à±à°ªà°¿à°Ÿà°²à± à°²à±‹ à°šà±†à°²à±à°²à°¿à°‚à°šà°‚à°¡à°¿</button>
            
            <!-- Cashfree Payment Button - Disabled with popup -->
            <form style="margin: 15px 0;">
                <div class="button-container disabled-payment" style="background: #2ca6a5; opacity: 0.6; cursor: not-allowed;" onclick="showDisabledPaymentPopup()">
                    <div>
                        <img src="https://cashfree-checkoutcartimages-prod.cashfree.com/ChatGPT Image Apr 19, 2025, 01_22_02 AMh97gq0or2rh0_prod.png" alt="logo" class="logo-container">
                    </div>
                    <div class="text-container">
                        <div style="font-family: Times New Roman; color: #ffffff; margin-bottom: 5px; font-size: 14px;">
                            UPI (Phonepe-Gpay) - Temporarily Unavailable
                        </div>
                        <div style="font-family: Times New Roman; color: #ffffff; font-size: 10px;">
                            <span>Powered By Cashfree</span>
                            <img src="https://cashfreelogo.cashfree.com/cashfreepayments/logosvgs/Group_4355.svg" alt="logo" class="seconday-logo-container">
                        </div>
                    </div>
                </div>
            </form>
            
            <button class="modal-btn" id="closeModal">Cancel(à°°à°¦à±à°¦à± à°šà±‡à°¯à°‚à°¡à°¿)</button>
        </div>
        
    </div>
</div>

<!-- UPI Loading Modal -->
<div class="modal" id="upiLoadingModal" style="display: none;">
    <div class="modal-content">
        <div class="upi-loading-content">
            <div class="upi-spinner">
                <div class="upi-spinner-ring"></div>
                <div class="upi-spinner-ring"></div>
                <div class="upi-spinner-ring"></div>
            </div>
            <h3>Creating Cashfree Payment...</h3>
            <p>Please wait while we prepare your UPI payment</p>
            <div class="upi-progress-bar">
                <div class="upi-progress-fill"></div>
            </div>
        </div>
    </div>
</div>

<!-- Receipt Loading Modal -->
<div class="modal" id="receiptLoadingModal" style="display: none;">
    <div class="modal-content">
        <div class="receipt-loading-content">
            <div class="receipt-animation">
                <div class="receipt-paper">
                    <div class="receipt-lines">
                        <div class="receipt-line"></div>
                        <div class="receipt-line"></div>
                        <div class="receipt-line"></div>
                        <div class="receipt-line"></div>
                        <div class="receipt-line"></div>
                    </div>
                    <div class="receipt-stamp">
                        <div class="stamp-circle">
                            <span class="stamp-text">PAID</span>
                        </div>
                    </div>
                </div>
                <div class="receipt-shine"></div>
            </div>
            <h3>Generating Your Receipt...</h3>
            <p>Please wait while we prepare your appointment receipt</p>
            <div class="receipt-progress">
                <div class="receipt-progress-bar">
                    <div class="receipt-progress-fill"></div>
                </div>
                <div class="receipt-progress-text">
                    <span id="receiptProgressText">Processing payment...</span>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Disabled Payment Popup Modal -->
<div class="modal" id="disabledPaymentModal" style="display: none;">
    <div class="modal-content disabled-payment-popup">
        <div class="disabled-payment-close" onclick="closeDisabledPaymentPopup()">
            <i class="fas fa-times"></i>
        </div>
        <div class="disabled-payment-content">
            <div class="disabled-payment-icon">
                <i class="fas fa-shield-alt"></i>
            </div>
            <h3>Payment Method Temporarily Unavailable</h3>
            <p class="disabled-payment-message">
                We're sorry, but online payment methods are currently disabled for security reasons. 
                Please use the "Pay at Hospital" option to complete your appointment booking.
            </p>
            <div class="disabled-payment-features">
                <div class="feature-item">
                    <i class="fas fa-check-circle"></i>
                    <span>Secure payment at hospital</span>
                </div>
                <div class="feature-item">
                    <i class="fas fa-check-circle"></i>
                    <span>No additional charges</span>
                </div>
                <div class="feature-item">
                    <i class="fas fa-check-circle"></i>
                    <span>Instant confirmation</span>
                </div>
            </div>
            <div class="disabled-payment-buttons">
                <button class="modal-btn pay-hospital" onclick="proceedWithPayAtHospital()">
                    <i class="fas fa-hospital"></i>
                    Continue with Pay at Hospital
                </button>
                <button class="modal-btn pay-hospital-secondary" onclick="closeDisabledPaymentPopup()">
                    <i class="fas fa-credit-card"></i>
                    Pay at Hospital - Book Now
                </button>
            </div>
        </div>
    </div>
</div>

<!-- Cashfree Error Handling - now auto-creates Pay at Hospital appointment -->

<script>
/* Advanced appointment animation logic */
document.addEventListener('DOMContentLoaded', function() {
    // Hamburger menu functionality
    const hamburger = document.getElementById('hamburger');
    const navMenu = document.getElementById('nav-menu');
    
    if (hamburger && navMenu) {
        hamburger.addEventListener('click', function() {
            hamburger.classList.toggle('active');
            navMenu.classList.toggle('open');
        });
        
        // Close menu when clicking on a link
        const navLinks = navMenu.querySelectorAll('a');
        navLinks.forEach(link => {
            link.addEventListener('click', function() {
                hamburger.classList.remove('active');
                navMenu.classList.remove('open');
            });
        });
        
        // Close menu when clicking outside
        document.addEventListener('click', function(event) {
            if (!hamburger.contains(event.target) && !navMenu.contains(event.target)) {
                hamburger.classList.remove('active');
                navMenu.classList.remove('open');
            }
        });
    }
    
    // Animate logo image
    const logoImg = document.querySelector('header img');
    if (logoImg) {
        logoImg.style.opacity = 0;
        setTimeout(() => {
            logoImg.style.transition = 'opacity 1.2s cubic-bezier(.77,0,.18,1)';
            logoImg.style.opacity = 1;
        }, 200);
    }

    // Animate form fields on focus
    document.querySelectorAll('.form-control').forEach(el => {
        el.addEventListener('focus', function() {
            this.parentElement.querySelector('label').style.color = 'var(--accent)';
        });
        el.addEventListener('blur', function() {
            this.parentElement.querySelector('label').style.color = 'var(--primary)';
        });
    });

    // Animate button on click
    const appointmentBtn = document.getElementById('appointmentBtn');
    if (appointmentBtn) {
        appointmentBtn.addEventListener('mousedown', function() {
            this.style.transform = 'scale(0.97)';
        });
        appointmentBtn.addEventListener('mouseup', function() {
            this.style.transform = '';
        });
    }
});

// 3D popup logic
const modal3d = document.getElementById('modal3d');
const backMessage = document.getElementById('backMessage');

const backCloseEl = document.getElementById('backClose');
if (backCloseEl) {
    backCloseEl.addEventListener('click', function(){
        if (modal3d) modal3d.classList.remove('show-back');
        const pm = document.getElementById('paymentModal');
        if (pm) pm.style.display = 'none';
    });
}

document.getElementById('closeModal').addEventListener('click', function(){
    document.getElementById('paymentModal').style.display = 'none';
    modal3d.classList.remove('show-back');
});

// Token generation and management
let appointmentCounter = localStorage.getItem('appointmentCounter') || 0;

// Function to generate a unique token in KAMALA-OP(001) format
function generateToken() {
    appointmentCounter = parseInt(appointmentCounter) + 1;
    localStorage.setItem('appointmentCounter', appointmentCounter);
    const formattedNumber = appointmentCounter.toString().padStart(3, '0');
    return `KAMALA-OP(${formattedNumber})`;
}



// âœ… Set min date
document.addEventListener('DOMContentLoaded', function() {
    // Use production server by default, localhost only for development
    if (window.location.hostname === 'localhost' || window.location.hostname === '127.0.0.1') {
        window.BACKEND_BASE = 'http://localhost:3000';
    } else {
        window.BACKEND_BASE = 'https://hospital-backend-78ur.onrender.com';
    }
    const today = new Date();
    const yyyy = today.getFullYear();
    let mm = today.getMonth() + 1;
    let dd = today.getDate();
    if(dd<10) dd='0'+dd;
    if(mm<10) mm='0'+mm;
    document.getElementById('date').setAttribute('min', `${yyyy}-${mm}-${dd}`);
});

// --- Modal Logic Rewrite ---

// 1. On form submit, show payment modal only (not success popup)
document.getElementById('appointmentForm').addEventListener('submit', function(e){
    e.preventDefault();

    const fullName = document.getElementById('fullName').value;
    const phone = document.getElementById('phone').value;
    const age = document.getElementById('age').value;
    const gender = document.getElementById('gender').value;
    const role = document.getElementById('role').value;
    const date = document.getElementById('date').value;
    const time = document.getElementById('time').value;
    const reason = document.getElementById('reason').value;

    if(!fullName || !phone || !age || !gender || !role || !date || !time){
        alert('Please fill all required fields(à°…à°¨à±à°¨à°¿ à°µà°¿à°µà°°à°¾à°²à± à°¸à°°à±ˆà°¨à°¦à°¿à°—à°¾ à°¨à°¿à°‚à°ªà°‚à°¡à°¿.)');
        return;
    }

    // Store patient phone for receipt lookup
    localStorage.setItem('patientPhone', phone);

    // Show payment method modal
    document.getElementById('paymentModal').style.display = 'block';
});

// Payment processing flag to prevent duplicate calls
let isProcessingPayment = false;

// New simplified payment functions
async function payAtHospital() {
    // Prevent duplicate calls
    if (isProcessingPayment) {
        console.log('Payment already being processed, ignoring duplicate call');
        return;
    }
    
    isProcessingPayment = true;
    
    // Hide payment modal immediately
    document.getElementById('paymentModal').style.display = 'none';
    
    const token = generateToken();
    
    try {
        console.log('ðŸ¥ Creating Pay at Hospital appointment...', {
            token: token,
            name: document.getElementById('fullName').value,
            phone: document.getElementById('phone').value,
            age: document.getElementById('age').value,
            gender: document.getElementById('gender').value,
            department: document.getElementById('role').value,
            appointmentDate: document.getElementById('date').value + " " + document.getElementById('time').value,
            reason: document.getElementById('reason').value
        });
        
        // Prepare complete appointment data for MongoDB
        const appointmentData = {
            orderId: `OFFLINE_${Date.now()}`,
            token: token,
            name: document.getElementById('fullName').value,
            phone: document.getElementById('phone').value,
            age: document.getElementById('age').value,
            gender: document.getElementById('gender').value,
            department: document.getElementById('role').value,
            appointmentDate: document.getElementById('date').value + " " + document.getElementById('time').value,
            reason: document.getElementById('reason').value,
            paymentStatus: "Pay at Hospital",
            paymentDate: new Date(),
            lastUpdated: new Date(),
            createdAt: new Date()
        };
        
        console.log('ðŸ’¾ Storing appointment in database:', appointmentData);
        
        // Try to fetch with timeout
        const controller = new AbortController();
        const timeoutId = setTimeout(() => controller.abort(), 15000); // Increased to 15 seconds
        
        const res = await fetch(`${window.BACKEND_BASE}/api/mongodb/appointments`, {
            method: "POST",
            headers: { 
                "Content-Type": "application/json",
                "Accept": "application/json"
            },
            body: JSON.stringify(appointmentData),
            signal: controller.signal
        });
        
        clearTimeout(timeoutId);
        
        if (!res.ok) {
            throw new Error(`Server error: ${res.status} ${res.statusText}`);
        }
        
        const data = await res.json();
        console.log('ðŸ“‹ Database response:', data);
        
        if (data.success) {
            // Also store in localStorage as backup
            localStorage.setItem('appointmentData', JSON.stringify(appointmentData));
            
            // Show animated success popup
            const appointmentSuccess = document.getElementById('appointmentSuccess');
            const successToken = document.getElementById('successToken');
            successToken.textContent = 'Your Token: ' + token;
            appointmentSuccess.style.display = 'flex';
            setTimeout(() => {
                appointmentSuccess.style.opacity = 1;
            }, 10);
            setTimeout(() => {
                appointmentSuccess.style.opacity = 0;
                setTimeout(() => {
                    appointmentSuccess.style.display = 'none';
                    // Show receipt loading modal
                    showReceiptLoadingModal();
                    // Redirect to receipt after loading animation
                    setTimeout(() => {
                        // Use token from response if available, otherwise use generated token
                        const receiptToken = (data.appointment && data.appointment.token) ? data.appointment.token : token;
                        console.log('ðŸ”— Redirecting to receipt with token:', receiptToken);
                        window.location.href = `receipt.html?token=${encodeURIComponent(receiptToken)}`;
                    }, 3000);
                }, 600);
            }, 2200);
            
            // Reset form
            document.getElementById('appointmentForm').reset();
        } else {
            throw new Error(data.message || 'Failed to create appointment');
        }
    } catch (err) {
        console.error('âŒ Pay at Hospital error:', err);
        
        // Handle different types of errors
        let errorMessage = "Error creating appointment: ";
        if (err.name === 'AbortError') {
            errorMessage += "Request timed out. Please check your internet connection and try again.";
        } else if (err.message.includes('Failed to fetch')) {
            errorMessage += "Cannot connect to server. Please check your internet connection or try again later.";
        } else if (err.message.includes('CORS')) {
            errorMessage += "Server connection blocked. Please try again.";
        } else {
            errorMessage += err.message;
        }
        
        // Ask user if they want to create a local appointment
        const createLocal = confirm(errorMessage + "\n\nWould you like to create a local appointment that you can confirm at the hospital?");
        
        if (createLocal) {
            // Create local appointment without backend
            const appointmentData = {
                token: token,
                name: document.getElementById('fullName').value,
                phone: document.getElementById('phone').value,
                age: document.getElementById('age').value,
                gender: document.getElementById('gender').value,
                department: document.getElementById('role').value,
                appointmentDate: document.getElementById('date').value + " " + document.getElementById('time').value,
                appointmentTime: document.getElementById('time').value,
                reason: document.getElementById('reason').value,
                paymentStatus: "Pay at Hospital",
                paymentMethod: "Pay at Hospital",
                status: "Pay at Hospital",
                appointmentStatus: "Confirmed",
                stamp: "PAY AT HOSPITAL",
                createdAt: new Date().toISOString()
            };
            
            console.log('ðŸ’¾ Creating local appointment:', appointmentData);
            localStorage.setItem('appointmentData', JSON.stringify(appointmentData));
            
            // Show success popup
            const appointmentSuccess = document.getElementById('appointmentSuccess');
            const successToken = document.getElementById('successToken');
            successToken.textContent = 'Your Token: ' + token;
            appointmentSuccess.style.display = 'flex';
            setTimeout(() => {
                appointmentSuccess.style.opacity = 1;
            }, 10);
            setTimeout(() => {
                appointmentSuccess.style.opacity = 0;
                setTimeout(() => {
                    appointmentSuccess.style.display = 'none';
                    // Show receipt loading modal
                    showReceiptLoadingModal();
                    // Redirect to receipt after loading animation
                    setTimeout(() => {
                        window.location.href = `receipt.html?token=${encodeURIComponent(token)}`;
                    }, 3000);
                }, 600);
            }, 2200);
            
            // Reset form
            document.getElementById('appointmentForm').reset();
        } else {
            // Show payment modal again
            document.getElementById('paymentModal').style.display = 'block';
        }
    } finally {
        // Reset processing flag
        isProcessingPayment = false;
    }
}

// Cashfree UPI payment function
async function payWithCashfree() {
    // Hide payment modal
    document.getElementById('paymentModal').style.display = 'none';
    
    // Show UPI loading modal
    showUpiLoadingModal();

    const token = generateToken();

    try {
        console.log('Sending Cashfree payment request to:', `${window.BACKEND_BASE}/create-upi-order`);
        
        const res = await fetch(`${window.BACKEND_BASE}/create-upi-order`, {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify({
                token: token,
                name: document.getElementById('fullName').value,
                phone: document.getElementById('phone').value,
                department: document.getElementById('role').value,
                appointmentDate: document.getElementById('date').value + " " + document.getElementById('time').value,
                reason: document.getElementById('reason').value,
                amount: 100 // OP consultation fee
            })
        });
        
        console.log('Response status:', res.status);
        console.log('Response headers:', res.headers);
        
        if (!res.ok) {
            throw new Error(`HTTP error! status: ${res.status}`);
        }
        
        const data = await res.json();
        console.log('Cashfree Response:', data); // Debug log
        
        if (data.success) {
            // Store appointment data for receipt
            localStorage.setItem('appointmentData', JSON.stringify({
                token: token,
                name: document.getElementById('fullName').value,
                phone: document.getElementById('phone').value,
                age: document.getElementById('age').value,
                gender: document.getElementById('gender').value,
                department: document.getElementById('role').value,
                appointmentDate: document.getElementById('date').value + " " + document.getElementById('time').value,
                appointmentTime: document.getElementById('time').value,
                reason: document.getElementById('reason').value,
                orderId: data.orderId,
                paymentStatus: "Pending",
                paymentMethod: "UPI"
            }));
            
            // Hide loading modal
            hideUpiLoadingModal();
            
            // Debug the payment URL
            console.log('Payment URL:', data.paymentUrl);
            console.log('Payment URL type:', typeof data.paymentUrl);
            console.log('Current location:', window.location.href);
            
            // Redirect user to Cashfree payment URL
            if (data.paymentUrl && data.paymentUrl !== 'undefined') {
                console.log('Redirecting to:', data.paymentUrl);
                window.location.href = data.paymentUrl;
            } else {
                console.error('Payment URL is undefined or invalid!');
                console.error('Full response:', data);
                alert('Payment URL not received. Please try again.');
            }
        } else {
            throw new Error(data.message || 'Failed to create Cashfree payment');
        }
    } catch (err) {
        console.error('âŒ Cashfree payment error:', err);
        hideUpiLoadingModal();
        
        // Show error message and let user choose
        alert('UPI payment failed. Please try "Pay at Hospital" option instead.');
        
        // Show payment modal again
        document.getElementById('paymentModal').style.display = 'block';
    }
}
// Cashfree UPI payment function completed

// Close modal
document.getElementById('closeModal').addEventListener('click', function(){
    document.getElementById('paymentModal').style.display = 'none';
});

// UPI Modal Functions
function showUpiLoadingModal() {
    document.getElementById('upiLoadingModal').style.display = 'flex';
}

function hideUpiLoadingModal() {
    document.getElementById('upiLoadingModal').style.display = 'none';
}

// Receipt Loading Modal Functions
function showReceiptLoadingModal() {
    document.getElementById('receiptLoadingModal').style.display = 'flex';
    startReceiptProgressAnimation();
}

function hideReceiptLoadingModal() {
    document.getElementById('receiptLoadingModal').style.display = 'none';
}

function startReceiptProgressAnimation() {
    const progressTexts = [
        'Processing payment...',
        'Verifying transaction...',
        'Updating database...',
        'Generating receipt...',
        'Finalizing details...',
        'Almost ready...'
    ];
    
    let currentIndex = 0;
    const progressTextElement = document.getElementById('receiptProgressText');
    
    const interval = setInterval(() => {
        if (currentIndex < progressTexts.length) {
            progressTextElement.textContent = progressTexts[currentIndex];
            currentIndex++;
        } else {
            clearInterval(interval);
        }
    }, 500);
    
    // Auto-hide after 3 seconds
    setTimeout(() => {
        hideReceiptLoadingModal();
    }, 3000);
}

// Disabled Payment Popup Functions
function showDisabledPaymentPopup() {
    document.getElementById('disabledPaymentModal').style.display = 'flex';
    // Add a slight delay for smooth animation
    setTimeout(() => {
        document.getElementById('disabledPaymentModal').style.opacity = '1';
    }, 10);
}

function closeDisabledPaymentPopup() {
    const modal = document.getElementById('disabledPaymentModal');
    modal.style.opacity = '0';
    setTimeout(() => {
        modal.style.display = 'none';
        // Just close the popup, don't proceed with Pay at Hospital
        // User can choose to click the Pay at Hospital button manually
    }, 300);
}

function proceedWithPayAtHospital() {
    // Close the disabled payment popup
    const modal = document.getElementById('disabledPaymentModal');
    modal.style.opacity = '0';
    setTimeout(() => {
        modal.style.display = 'none';
        // Close the main payment modal and proceed with Pay at Hospital
        document.getElementById('paymentModal').style.display = 'none';
        payAtHospital();
    }, 300);
}

// Cashfree error handling - now auto-creates Pay at Hospital appointment
</script>

</body>
</html>